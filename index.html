<!DOCTYPE html>
<html lang="en">

<head>
	<link rel="stylesheet" type="text/css" href="bootstrap/navstyle.css">
	<link rel="stylesheet" type="text/css" href="./bootstrap/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="./styles.css">
</head>
<div class="topnav sticky-top d-flex opacity-80">
    <img style="margin: 5px" src="./crystal-brand.svg" width="45" height="45" alt="">
	<a class="active" href="#">Home</a>
    <a href="#overview">Overview</a>
    <a href="#comparison">Comparison</a>
    <a href="#concurrency">Concurrency</a>
</div>


<body>
    <!-- <nav class="navbar navbar-light sticky-top bg-light">
        <a class="navbar-brand" href="#">
            <img src="./crystal-brand.svg" width="40" height="40" alt="">
            Crystal - Sparrows
        </a>
    </nav> -->
    <h1 style="text-align: center">The Crystal Programming Language</h1>
    <hr id="overview"></hr>
    <h2>History, References, Examples and Install</h2>

    <div class="card container content">
        <div class="card-body">
            <h4 class="card-title">History and Overview</h4>
            <p class="card-text">Crystal is an object-oriented programming language that was designed by Ary Borenszweig, Juan Wajnerman, Brian
                Cardiff, along over 300 other contributors.
                The language began development in June 2011, in order to create a language that had the productivity of Ruby but
                the speed of a compiled language (C in particular).
                It is a compiled language that has static type-checking. Crystal is syntactically similar to Ruby and the first
                ever Crystal compiler was written in Ruby.
                The first crystal compiler was written in November 13th, officially making the language self-hosting. The first
                official release was in June 2014. </p>
        </div>
    </div>
    
    <div class="card container content">
        <div class="card-body">
            <h4 class="card-title">Documentation, Tutorials, and References</h4>
            <div class="card-text">
                <p>Tutorial: <a href="https://www.youtube.com/watch?v=DxFP-Wjqtsc">Learn Crystal in one Video</a></p>
                <p>Documentation: <a href="https://crystal-lang.org/docs/">Official Crystal Documentation Site</a></p>
                <p>API: <a href="https://crystal-lang.org/api/0.31.1/">Official Crystal API</a></p>
                <p>Other Helpful Reference: <a href="https://crystal-lang.org/reference/">Crystal-Lang Reference</a></p>
                <p>Syntax Reference: <a href="https://crystal-lang.org/reference/syntax_and_semantics/">Crystal-Lang Syntax Help</a>
                </p>
            </div>
        </div>
    </div>
	
	<div class="card container content">
		<div class="card-body">
			<h4 class="card-title">Install Instructions</h4>
			<div class="card-text">
				<p>Official Link: <a href="https://crystal-lang.org/install/">Install Crystal</a></p>
				<p>This page displays all the platforms in which Crystal is available to run on.
					Each platform you select has its own set of instructions on how to install the language.</p>
			</div>
		</div>
	</div>
		
	<div class="card container content">
		<div class="card-body">
			<h4 class="card-title">Introductory Programs</h4>
			<p class="card-text">Hello World Program in Crystal:</p>
			<pre class="card-text">
            <code>
            puts "Hello World!"
            </code>
            </pre>
			<p class="card-text">Hello World Program. Using the Object-Oriented Style:</p>
			<pre class="card-text">
            <code>
            class HelloWorld
                def initialize(@name : String)
                end
                def greeting
                    puts "Hello #{@name}!"
                end
            end
            g = HelloWorld.new("world")
            g.greeting
            </code>
			</pre>
		</div>
    </div>
    
    <hr id="comparison">
    <h2>Comparison With Other Languages</h2>

    <!-- Execution Time -->
    <div class="card container content">
        <div class="card-body">
                <h5 class="card-title">Performance - Execution Time (Average Time/Task)</h5>
                <table class="card-text table">
                    <thead class="thead-light">
                        <tr>
                            <th scope="col">Task</th>
                            <th scope="col">Crystal</th>
                            <th scope="col">Ruby</th>
                            <th scope="col">C</th>
                            <th scope="col">Go</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th scope="row">BCrypt Hash</th>
                            <td>1.181s</td>
                            <td>nil</td>
                            <td>nil</td>
                            <td>0.255s</td>
                        </tr>
                        <tr>
                            <th scope="row">Pi Approximation</th>
                            <td>0.010s</td>
                            <td>nil</td>
                            <td>nil</td>
                            <td>0.001s</td>
                        </tr>
                        <tr>
                            <th scope="row">3</th>
                            <td>nil</td>
                            <td>nil</td>
                            <td>nil</td>
                            <td>nil</td>
                        </tr>
                    </tbody>
                </table>
        </div>
    </div>

    <!-- Compile Time -->
    <div class="card container content">
        <div class="card-body">
            <h5 class="card-title">Performance - Compile Time</h5>
            <table class="card-text table">
                <thead class="thead-light">
                    <tr>
                        <th scope="col">Program</th>
                        <th scope="col">Crystal</th>
                        <th scope="col">Ruby</th>
                        <th scope="col">C</th>
                        <th scope="col">Go</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <th scope="row">BCrypt Hash</th>
                        <td>1.073s</td>
                        <td>nil</td>
                        <td>nil</td>
                        <td>0.271s</td>
                    </tr>
                    <tr>
                        <th scope="row">Pi Approximation</th>
                        <td>0.978</td>
                        <td>nil</td>
                        <td>nil</td>
                        <td>0.25s</td>
                    </tr>
                    <tr>
                        <th scope="row">3</th>
                        <td>nil</td>
                        <td>nil</td>
                        <td>nil</td>
                        <td>nil</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Executable Size -->
    <div class="card container content">
        <div class="card-body">
            <h5 class="card-title">Performance - Binary Size</h5>
            <table class="card-text table">
                <thead class="thead-light">
                    <tr>
                        <th scope="col">Program</th>
                        <th scope="col">Crystal</th>
                        <th scope="col">Ruby</th>
                        <th scope="col">C</th>
                        <th scope="col">Go</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <th scope="row">BCrypt Hash</th>
                        <td>1554 KB</td>
                        <td>n/a</td>
                        <td>nil</td>
                        <td>2374 KB</td>
                    </tr>
                    <tr>
                        <th scope="row">Pi Approximation</th>
                        <td>1332 KB</td>
                        <td>n/a</td>
                        <td>nil</td>
                        <td>2085 KB</td>
                    </tr>
                    <tr>
                        <th scope="row">3</th>
                        <td>nil</td>
                        <td>n/a</td>
                        <td>nil</td>
                        <td>nil</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
        <hr id="Typing"></hr>
    <div class="card container content">
		<div class="card-body">
			<h2 class="card-title">Typing</h2>
			<p class="card-text">Crystal is heavily object oriented, and each object has a type. A comprehensive list of type literals can be found here: <a href="https://crystal-lang.org/reference/syntax_and_semantics/literals.html">Crystal Literals</a></p>
            <p class="card-text"> Something special to note is that Crystal has multiple types for ints, with each differing type defining their length or sign. There is an int type for sizes 8, 16, 32, and 64, with unsigned version for each as well. Examples : Int32, UInt64, Int8, UInt8 </p>
            <p class="card-text"> Crystal is designed to avoid type declaration if possible, but that doesn't mean it is dynamically typed. The compiler attempts to infer the type of each variable based on declarations, so most type errors are still caught at compile time rather than run time.</p>
            <p class="card-text"> There are a set of rules that the compiler follows when attempting to figure out the type of an object. For example, if an object is assigned a literal, it will be the type of that literal.</p>
			<pre class="card-text">
            <code>
            var = "hello world"
            puts typeof(var)    # Since "hello world" is a literal, var is a String
            </code>
            </pre>
			<p class="card-text"> If you can easily infer the type of a variable by reading the code, it is very likely that one of the compilers many type inference rules was able to make the same conclusion.</p>
            <p class="card-text"> Once the compiler has decided the object's type based off of its declaration, any methods used on it that don't match its type will cause a compile-time error.</p>
            <p class="card-text"> However, sometimes it isn't certain what type a variable is. In Crystal, it is possible for a variable to have multiple possible initial values with different types.</p>
            <p class="card-text"> If this happens, the compiler type checks the variable as a Union of any possible types it might be. In the following example, it's possible that foo is assigned either a String or Int32 value. The compiler handles its type as the Union (String | Int32) when it checks for illegal options.</p>
			<pre class="card-text">
            <code>
            var = "hello world"
            rand > 0.5 ? (foo = var) : (foo = 2)   # Another typing rule: since var is String, foo is String
            puts typeof(foo)    # Compile time type, a Union
            puts foo.class      # Run time type
            puts foo            # puts can take either type, so no errors

            # puts foo.upcase   - Results in a compile time error, since the 
            #                     upcase method isn't defined for Int32
            </code>
			</pre>
            <p class="card-text"> This also works for variables that might not have been initialized. The Nil type is added to the variable's type union.</p>
            <pre class="card-text">
            <code>
            if (rand > 0.5)
              bar = "This may or may not show up"
            end

            if(bar.nil?)
              puts "Error! Variable not initialized"
            else 
              puts bar
            end
            </code>
			</pre>
            <p class="card-text"> Alternatively, on of the many provided type checking methods could be used to handle Unions. The nil? method was shown earlier, but other more complex methods are provided too. The responds_to? method checks to see if a variable would respond to a given method.</p>
            <pre class="card-text">
            <code>
            rand > 0.5 ? (foo = "wow!") : (foo = 2)

            if(foo.responds_to?(:upcase))
              puts foo.upcase
            else 
              puts "Method \"upcase\" is not defined for foo"
            end
            </code>
			</pre>
            <p class="card-text"> Method variables don't have to be typed, considering illegal actions on a explicitly defined type and an infered type will both be caught at compile time. However, just like with normal variables, it might not always be obvious to the somebody reading the code what the type of a variable is if it isn't defined.</p>
            <p class="card-text"> Additionally, typing methods variables can be used for overloading, which is another way of handling Unity types if needed. A variable's type can be defined by using the form "var : Type".</p>
            <pre class="card-text">
            <code>
            rand > 0.5 ? (foo = "wow!") : (foo = 2)

            # Methods return the value of their final line by default, but the return keyword can be used
            # The return type of a method can also be infered.

            def upper(bar : String)
              bar.upcase
            end

            def upper(num : Int32)
              "Variable is not a String!"
            end

            puts upper foo      # The program will use the correct method
            </code>
			</pre>
            <p class="card-text"> In the following example, the * character is a "splat". It allows any number of variables to be passed into the function. Since the splat is not explicitly type-defined, the variables can be of any type, as long as no incompatible methods are called.</p>
            <p class="card-text"> The passed in variables are stored as a Tuple, with each element in the Tuple having its own defined type.</p>
            <pre class="card-text">
            <code>
            def typeCount(*vars)
              puts "The vars Tuple has the following types: #{vars.class}" 
              strCount = 0
              numCount = 0
              otherCount = 0
              vars.each do |var|
                if (var.responds_to?(:/)) # There are many numeric types (Int32, Int64, Float32...)
                  numCount += 1
                elsif (var.is_a?(String)) 
                  strCount += 1
                else
                  otherCount += 1
                end
              end
              puts "Number of numbers: #{numCount}"
              puts "Number of strings: #{strCount}"
              puts "Number of other objects: #{otherCount}"
            end

            typeCount 1, 2, 3.14, "hello", "goodbye", [1,2,3]
            </code>
			</pre>
            <p class="card-text">A more complete documentation of Crystal's typing system can be found here: <a href="https://crystal-lang.org/reference/syntax_and_semantics/types_and_methods.html">Crystal Types</a></p>
            <p class="card-text">The following is a collected demonstration of all of the code examples used in this section:</p>
            <div align="center">
                <iframe src="https://play.crystal-lang.org/#/r/81ki/edit"
                        width="70%"
                        height="500px"
                        frameborder="1"
                        scrolling="yes">
                </iframe>
            </div>
		</div>
    </div>
    <!-- Concurrency (Chris Haney) -->
    <hr id="concurrency"></hr>
    <h2 style="text-align: center">Concurrency</h2>
    <div class="card container content">
        <div class="card-body">
            <div class="card-text">
                    <p>
                        At this time, a Crystal program executes in a single operating system thread
                        "... Except the Garbage Collector (GC) which implements a concurrent mark-and-sweep (currently Boehm GC)."
                        This means that Crystal doesn't currently support parallelism, but it does support concurrency.
                    </p>
            </div>
        </div>
    </div>
    
    <div class="card container content">
        <div class="card-body">
            <h4 class="card-title">What is concurrency?</h4>
            <div class="card-text">
                    <p>
                        Concurrency allows programmers to execute things the way they want instead of purely sequentially.
                        The most straightforward use of concurrency is to execute something else while waiting for user input.
                    </p>
            </div>
        </div>
    </div>

    <div class="card container content">
        <div class="card-body">
            <h4 class="card-title">Crystal achieves concurrent processing in two ways...</h4>
            <div class="card-text">
                    <b>Fibers</b>
                        <p>An object designed to act like an operating system thread, with some key differences...</p>
                        <p>Each fiber is assigned its own lightweight call stack (starts at 4KB, up to 8MB)</p>
                        <p>Fibers use cooperative multitasking (They tag in and tag out as necessary) while standard threads use pre-emptive multitasking (I'm gonna run whether you like it or not!)</p>
                        <p>In Crystal, all programs invisibly spawn a main fiber which can yield execution to other fibers once it completes.</p>
                    <b>Channels</b>
                        <p>Pros: As long as you only communicate data with channels accessing and modifying data doesn't require things like locks and mutexes.</p>
                        <p>Cons: A Channel in Crystal can only have one object sent/received at a time. The more data you need to pass around, the more channels you will need.</p>
            </div>
        </div>
    </div>

    <div class="card container content">
            <div align="center" class="card-body">
                <h4 class="card-title">Example 1: Simple Fiber/Channel Usage</h4>
                <iframe src="https://play.crystal-lang.org/#/r/817w/edit"
                        width="100%"
                        height="500px"
                        frameborder="1"
                        scrolling="yes">
                </iframe>
            </div>
        </div>
    </div>

    <div class="card container content">
            <div align="center" class="card-body">
                <h4 class="card-title">Example 2: Race Condition</h4>
                <iframe src="https://play.crystal-lang.org/#/r/81ay/edit"
                    width="100%"
                    height="500px"
                    frameborder="1"
                    scrolling="yes">
                </iframe>
            </div>
        </div>
    </div>
</body>

